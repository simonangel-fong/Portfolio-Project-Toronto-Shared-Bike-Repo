name: Dev CI/CD

on:
  pull_request:
    paths:
      - "csv/**"
      - "lambda/**"
      - "module/**"
      - "dev/**"
      - "prod/**"
      - "web/**"
      - ".github/workflows/**"
  push:
    branches: ["master"]
    paths:
      - "csv/**"
      - "lambda/**"
      - "module/**"
      - "dev/**"
      - "prod/**"
      - "web/**"
      - ".github/workflows/**"
  workflow_dispatch: {}

env:
  TERRAFORM_VERSION: 1.7.5
  TF_PLUGIN_CACHE_DIR: ~/.terraform.d/plugin-cache
  TF_DEV_WORKING_DIR: dev
  TF_PROD_WORKING_DIR: prod
  TF_VAR_aws_region: ${{ vars.AWS_REGION }}
  TF_VAR_cloudflare_api_token: ${{secrets.CF_API_TOKEN}}
  TF_VAR_cloudflare_zone_id: ${{secrets.CF_ZONE}}

permissions:
  id-token: write
  contents: read

jobs:
  dev_terraform_val_plan:
    name: Dev-Terraform-Validate-Plan
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ${{ env.TF_DEV_WORKING_DIR }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: ${{ env.TERRAFORM_VERSION }}

      - name: Configure AWS credentials (OIDC)
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: ${{ secrets.AWS_TF_ROLE_ARN }}
          aws-region: ${{ env.TF_VAR_aws_region }}

      - name: Cache .terraform
        uses: actions/cache@v4
        with:
          path: |
            ~/.terraform.d/plugin-cache
            ${{ env.TF_DEV_WORKING_DIR }}/.terraform
          key: ${{ runner.os }}-tf-${{ hashFiles('**/.terraform.lock.hcl') }}
          restore-keys: |
            ${{ runner.os }}-tf-

      - name: Terraform init (S3 backend)
        run: |
          terraform init -reconfigure -input=false \
            -backend-config="bucket=${{ secrets.AWS_BACKEND_BUCKET }}" \
            -backend-config="region=${{ secrets.AWS_REGION }}" \
            -backend-config="key=${{ secrets.AWS_BACKEND_BUCKET_KEY_DEV }}" \
            -backend-config="encrypt=true"

      - name: Terraform fmt
        run: terraform fmt -check -recursive -no-color

      - name: Terraform validate
        run: terraform validate -no-color

      - name: Terraform plan
        run: terraform plan -out=tfplan -input=false -no-color

      - name: Save dev plan artifact
        uses: actions/upload-artifact@v4
        with:
          name: dev-tfplan
          path: ${{ env.TF_DEV_WORKING_DIR }}/tfplan

  dev_terraform_apply:
    name: Dev-Terraform-Apply
    needs: dev_terraform_val_plan
    if: github.ref == 'refs/heads/master'
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ${{ env.TF_DEV_WORKING_DIR }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: ${{ env.TERRAFORM_VERSION }}

      - name: Configure AWS credentials (OIDC)
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: ${{ secrets.AWS_TF_ROLE_ARN }}
          aws-region: ${{ env.TF_VAR_aws_region }}

      - name: Download plan artifact
        uses: actions/download-artifact@v4
        with:
          name: dev-tfplan
          path: ${{ env.TF_DEV_WORKING_DIR }}

      - name: Terraform init (S3 backend)
        run: |
          terraform init -reconfigure -input=false \
            -backend-config="bucket=${{ secrets.AWS_BACKEND_BUCKET }}" \
            -backend-config="region=${{ vars.AWS_REGION }}" \
            -backend-config="key=${{ secrets.AWS_BACKEND_BUCKET_KEY_DEV }}" \
            -backend-config="encrypt=true"

      - name: Terraform apply
        run: terraform apply -auto-approve -input=false -no-color tfplan

      # Notify: send email
      - name: Send email notification on success
        if: success()
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 587
          # secure: true
          username: ${{ secrets.EMAIL_USERNAME }}
          password: ${{ secrets.EMAIL_PASSWORD }}
          subject: "✅ Project - Toronto shared bike(Dev): Terraform Apply Success"
          to: ${{ secrets.EMAIL_USERNAME }}
          from: ${{ secrets.EMAIL_USERNAME }}
          html_body: |
            <h2>GitHub Actions CI/CD Notification</h2>
            <p><b>Project</b>: Toronto shared bike</p>
            <p><b>Repository</b>: ${{ github.repository }}</p>
            <p><b>Action</b>: Infrastructures update</p>
            <p><b>Env</b>: DEV</p>
            <p><b>Status</b>: success</p>
            <p>Branch: <b>${{ github.base_ref }}</b></p>
            <p>Workflow: <b>${{ github.workflow }}</b></p>
            <p>Commit: <b>${{ github.sha }}</b></p>
            <p><a href="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}">View Workflow Run</a></p>

      - name: Send email notification on failure
        if: failure()
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 587
          # secure: true
          username: ${{ secrets.EMAIL_USERNAME }}
          password: ${{ secrets.EMAIL_PASSWORD }}
          subject: "❌ Project - Toronto shared bike(Dev): Terraform Apply Failure"
          to: ${{ secrets.EMAIL_USERNAME }}
          from: ${{ secrets.EMAIL_USERNAME }}
          html_body: |
            <h2>GitHub Actions CI/CD Notification</h2>
            <p><b>Project</b>: Toronto shared bike</p>
            <p><b>Repository</b>: ${{ github.repository }}</p>
            <p><b>Action</b>: Infrastructures update</p>
            <p><b>Env</b>: DEV</p>
            <p><b>Status</b>: fail</p>
            <p>Branch: <b>${{ github.base_ref }}</b></p>
            <p>Workflow: <b>${{ github.workflow }}</b></p>
            <p>Commit: <b>${{ github.sha }}</b></p>
            <p><a href="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}">View Workflow Run</a></p>

  dev_smoke_test:
    name: Dev-Smoke Testing
    needs: dev_terraform_apply
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup K6
        uses: grafana/setup-k6-action@v1

      - name: Run local k6 test
        uses: grafana/run-k6-action@v1
        env:
          K6_CLOUD_TOKEN: ${{ secrets.K6_CLOUD_TOKEN }}
          K6_CLOUD_PROJECT_ID: ${{ secrets.K6_CLOUD_PROJECT_ID }}
          API_STAGE: "dev"
          HOME_URL: "https://trip-dev.arguswatcher.net"
        with:
          path: k6/script/cloud_smoke.js

  #     - name: Send SUCCESS email
  #       if: success()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "✅ Smoke Test(Dev) Passed — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ✅ The Dev Smoke Test has PASSED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Regards,
  #           GitHub Actions

  #     - name: Send FAILURE email
  #       if: failure()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "❌ Smoke Test(Dev) FAILED — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ❌ The Dev Smoke Test has FAILED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Please review the run logs above.

  #           Regards,
  #           GitHub Actions

  # dev_load_test:
  #   name: Dev-Load Testing
  #   needs: dev_smoke_test
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v4

  #     - name: Setup K6
  #       uses: grafana/setup-k6-action@v1

  #     - name: Run local k6 test
  #       uses: grafana/run-k6-action@v1
  #       env:
  #         K6_CLOUD_TOKEN: ${{ secrets.K6_CLOUD_TOKEN }}
  #         K6_CLOUD_PROJECT_ID: ${{ secrets.K6_CLOUD_PROJECT_ID }}
  #       with:
  #         path: k6/script/cloud_load.js

  #     - name: Send SUCCESS email
  #       if: success()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "✅ Dev Load Test Passed — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ✅ The Dev Load Test has PASSED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Regards,
  #           GitHub Actions

  #     - name: Send FAILURE email
  #       if: failure()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "❌ Dev Load Test FAILED — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ❌ The Dev Load Test has FAILED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Please review the run logs above.

  #           Regards,
  #           GitHub Actions

  # dev_stress_test:
  #   name: Dev-Stress Testing
  #   needs: dev_load_test
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v4

  #     - name: Setup K6
  #       uses: grafana/setup-k6-action@v1

  #     - name: Run local k6 test
  #       uses: grafana/run-k6-action@v1
  #       env:
  #         K6_CLOUD_TOKEN: ${{ secrets.K6_CLOUD_TOKEN }}
  #         K6_CLOUD_PROJECT_ID: ${{ secrets.K6_CLOUD_PROJECT_ID }}
  #       with:
  #         path: k6/script/cloud_stress.js

  #     - name: Send SUCCESS email
  #       if: success()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "✅ Dev Stress Test Passed — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ✅ The Stress Load Test has PASSED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Regards,
  #           GitHub Actions

  #     - name: Send FAILURE email
  #       if: failure()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "❌ Dev Stress Test FAILED — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ❌ The Dev Stress Test has FAILED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Please review the run logs above.

  #           Regards,
  #           GitHub Actions

  # # dev_test_spike:
  # #   name: Dev-Spike Testing
  # #   needs: dev_stress_test
  # #   runs-on: ubuntu-latest
  # #   steps:
  # #     - name: Checkout
  # #       uses: actions/checkout@v4

  # #     - name: Setup K6
  # #       uses: grafana/setup-k6-action@v1

  # #     - name: Run local k6 test
  # #       uses: grafana/run-k6-action@v1
  # #       env:
  # #         K6_CLOUD_TOKEN: ${{ secrets.K6_CLOUD_TOKEN }}
  # #         K6_CLOUD_PROJECT_ID: ${{ secrets.K6_CLOUD_PROJECT_ID }}
  # #       with:
  # #         path: k6/script/cloud_spike.js

  # #     - name: Send SUCCESS email
  # #       if: success()
  # #       uses: dawidd6/action-send-mail@v3
  # #       with:
  # #         server_address: smtp.gmail.com
  # #         server_port: 465
  # #         username: ${{ secrets.EMAIL_USERNAME }}
  # #         password: ${{ secrets.EMAIL_PASSWORD }}
  # #         to: ${{ secrets.EMAIL_USERNAME }}
  # #         from: ${{ secrets.EMAIL_USERNAME }}
  # #         subject: "✅ Dev Spike Test Passed — ${{ github.repository }}@${{ github.ref_name }}"
  # #         body: |
  # #           Hello Admin,

  # #           ✅ The Spike Load Test has PASSED.

  # #           Workflow: ${{ github.workflow }}
  # #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  # #           Commit: ${{ github.sha }}

  # #           Regards,
  # #           GitHub Actions

  # #     - name: Send FAILURE email
  # #       if: failure()
  # #       uses: dawidd6/action-send-mail@v3
  # #       with:
  # #         server_address: smtp.gmail.com
  # #         server_port: 465
  # #         username: ${{ secrets.EMAIL_USERNAME }}
  # #         password: ${{ secrets.EMAIL_PASSWORD }}
  # #         to: ${{ secrets.EMAIL_USERNAME }}
  # #         from: ${{ secrets.EMAIL_USERNAME }}
  # #         subject: "❌ Dev Spike Test FAILED — ${{ github.repository }}@${{ github.ref_name }}"
  # #         body: |
  # #           Hello Admin,

  # #           ❌ The Dev Spike Test has FAILED.

  # #           Workflow: ${{ github.workflow }}
  # #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  # #           Commit: ${{ github.sha }}

  # #           Please review the run logs above.

  # #           Regards,
  # #           GitHub Actions

  # Prod ENV
  prod_validate_plan:
    name: Prod-Terraform-Validate-Plan
    needs: dev_smoke_test
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ${{ env.TF_PROD_WORKING_DIR }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: ${{ env.TERRAFORM_VERSION }}

      - name: Configure AWS credentials (OIDC)
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: ${{ secrets.AWS_TF_ROLE_ARN }}
          aws-region: ${{ env.TF_VAR_aws_region }}

      - name: Cache .terraform
        uses: actions/cache@v4
        with:
          path: |
            ~/.terraform.d/plugin-cache
            ${{ env.TF_PROD_WORKING_DIR }}/.terraform
          key: ${{ runner.os }}-tf-${{ hashFiles('**/.terraform.lock.hcl') }}
          restore-keys: |
            ${{ runner.os }}-tf-

      - name: Terraform init (S3 backend)
        run: |
          terraform init -reconfigure -input=false \
            -backend-config="bucket=${{ secrets.AWS_BACKEND_BUCKET }}" \
            -backend-config="region=${{ secrets.AWS_REGION }}" \
            -backend-config="key=${{ secrets.AWS_BACKEND_BUCKET_KEY_PROD }}" \
            -backend-config="encrypt=true"

      - name: Terraform fmt
        run: terraform fmt -check -recursive -no-color

      - name: Terraform validate
        run: terraform validate -no-color

      - name: Terraform plan
        run: terraform plan -out=tfplan -input=false -no-color

      - name: Save prod plan artifact
        uses: actions/upload-artifact@v4
        with:
          name: prod-tfplan
          path: ${{ env.TF_PROD_WORKING_DIR }}/tfplan

  prod_apply:
    name: Prod-Terraform-Apply
    needs: prod_validate_plan
    if: github.ref == 'refs/heads/master'
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ${{ env.TF_PROD_WORKING_DIR }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: ${{ env.TERRAFORM_VERSION }}

      - name: Configure AWS credentials (OIDC)
        uses: aws-actions/configure-aws-credentials@v4
        with:
          role-to-assume: ${{ secrets.AWS_TF_ROLE_ARN }}
          aws-region: ${{ env.TF_VAR_aws_region }}

      - name: Download plan artifact
        uses: actions/download-artifact@v4
        with:
          name: prod-tfplan
          path: ${{ env.TF_PROD_WORKING_DIR }}

      - name: Terraform init (S3 backend)
        run: |
          terraform init -reconfigure -input=false \
            -backend-config="bucket=${{ secrets.AWS_BACKEND_BUCKET }}" \
            -backend-config="region=${{ vars.AWS_REGION }}" \
            -backend-config="key=${{ secrets.AWS_BACKEND_BUCKET_KEY_PROD }}" \
            -backend-config="encrypt=true"

      - name: Terraform apply
        run: terraform apply -auto-approve -input=false -no-color tfplan

  #     # Notify: send email
  #     - name: Send email notification on success
  #       if: success()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 587
  #         # secure: true
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         subject: "✅ Project - Toronto shared bike: Infrastructures update successed"
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         html_body: |
  #           <h2>GitHub Actions CI/CD Notification</h2>
  #           <p><b>Project</b>: Toronto shared bike</p>
  #           <p><b>Repository</b>: ${{ github.repository }}</p>
  #           <p><b>Action</b>: Infrastructures update</p>
  #           <p><b>Status</b>: success</p>
  #           <p>Branch: <b>${{ github.base_ref }}</b></p>
  #           <p>Workflow: <b>${{ github.workflow }}</b></p>
  #           <p>Commit: <b>${{ github.sha }}</b></p>
  #           <p><a href="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}">View Workflow Run</a></p>

  #     - name: Send email notification on failure
  #       if: failure()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 587
  #         # secure: true
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         subject: "❌ Project - Toronto shared bike: Infrastructures update failed"
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         html_body: |
  #           <h2>GitHub Actions CI/CD Notification</h2>
  #           <p><b>Project</b>: Toronto shared bike</p>
  #           <p><b>Repository</b>: ${{ github.repository }}</p>
  #           <p><b>Action</b>: Infrastructures update</p>
  #           <p><b>Status</b>: fail</p>
  #           <p>Branch: <b>${{ github.base_ref }}</b></p>
  #           <p>Workflow: <b>${{ github.workflow }}</b></p>
  #           <p>Commit: <b>${{ github.sha }}</b></p>
  #           <p><a href="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}">View Workflow Run</a></p>

  # prod_test_smoke:
  #   name: Dev-Smoke Testing
  #   needs: dev_terraform_apply
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v4

  #     - name: Setup K6
  #       uses: grafana/setup-k6-action@v1

  #     - name: Run local k6 test
  #       uses: grafana/run-k6-action@v1
  #       env:
  #         K6_CLOUD_TOKEN: ${{ secrets.K6_CLOUD_TOKEN }}
  #         K6_CLOUD_PROJECT_ID: ${{ secrets.K6_CLOUD_PROJECT_ID }}
  #       with:
  #         path: k6/script/cloud_smoke.js

  #     - name: Send SUCCESS email
  #       if: success()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "✅ Dev Smoke Test Passed — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ✅ The Dev Smoke Test has PASSED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Regards,
  #           GitHub Actions

  #     - name: Send FAILURE email
  #       if: failure()
  #       uses: dawidd6/action-send-mail@v3
  #       with:
  #         server_address: smtp.gmail.com
  #         server_port: 465
  #         username: ${{ secrets.EMAIL_USERNAME }}
  #         password: ${{ secrets.EMAIL_PASSWORD }}
  #         to: ${{ secrets.EMAIL_USERNAME }}
  #         from: ${{ secrets.EMAIL_USERNAME }}
  #         subject: "❌ Dev Smoke Test FAILED — ${{ github.repository }}@${{ github.ref_name }}"
  #         body: |
  #           Hello Admin,

  #           ❌ The Dev Smoke Test has FAILED.

  #           Workflow: ${{ github.workflow }}
  #           Run: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
  #           Commit: ${{ github.sha }}

  #           Please review the run logs above.

  #           Regards,
  #           GitHub Actions
