pipeline {
  agent any

  environment {
    POSTGRES_USER = credentials('postgres_user')
  }

  stages {

    stage('Cleanup Workspace & Checkout') {
        steps {
            echo "#################### Cleans the workspace ####################"
            cleanWs()
            
            echo "#################### Checkout ####################"
            checkout scm // Explicitly checks out the SCM after cleaning.

            sh """
              ls
              pwd
              echo "${POSTGRES_USER}"
            """
        }
    }
  }
}
 